@echo off
chcp 65001 >nul

echo üöÄ –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ gdfmt...

:: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è gdfmt
where gdscriptfmt >nul 2>&1
if %ERRORLEVEL% NEQ 0 (
    echo ‚ùå gdfmt –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ gdfmt.
    exit /b 1
)

:: –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî —Ç–µ–∫—É—â–∞—è
set DIRECTORY=.

:: –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω –ø—É—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ –∫–∞–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
if not "%~1"=="" set DIRECTORY=%~1

:: –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∫–∞–∑–∞–Ω–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
if not exist "%DIRECTORY%" (
    echo ‚ùå –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è %DIRECTORY% –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.
    exit /b 1
)

echo üöÄ –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã GDScript –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ %DIRECTORY%...

:: –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö .gd —Ñ–∞–π–ª–æ–≤
for /r "%DIRECTORY%" %%f in (*.gd) do (
    gdscriptfmt "%%f"
)

:: –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
if %ERRORLEVEL% EQU 0 (
    echo ‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã GDScript —É—Å–ø–µ—à–Ω–æ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω—ã!
) else (
    echo ‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤.
    exit /b 1
)
