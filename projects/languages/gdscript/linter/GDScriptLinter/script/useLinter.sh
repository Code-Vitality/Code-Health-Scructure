#!/bin/bash

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ gdscript-linter
if ! command -v gdscript-linter &> /dev/null
then
    echo "‚ùå gdscript-linter –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ gdscript-linter."
    exit 1
fi

# –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî —Ç–µ–∫—É—â–∞—è
DIRECTORY="."

# –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω –ø—É—Ç—å, —Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ –∫–∞–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
if [ $# -gt 0 ]; then
    DIRECTORY="$1"
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∫–∞–∑–∞–Ω–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
if [ ! -d "$DIRECTORY" ]; then
    echo "‚ùå –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è $DIRECTORY –Ω–µ –Ω–∞–π–¥–µ–Ω–∞."
    exit 1
fi

echo "üöÄ –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã GDScript –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ $DIRECTORY..."

# –†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö .gd —Ñ–∞–π–ª–æ–≤
gdscript-linter -r "$DIRECTORY"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏
if [ $? -eq 0 ]; then
    echo "‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã GDScript –ø—Ä–æ—à–ª–∏ –ª–∏–Ω—Ç–∏–Ω–≥!"
else
    echo "‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ –∫–æ–¥–µ GDScript."
    exit 1
fi
